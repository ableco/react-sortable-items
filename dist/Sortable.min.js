var Sortable=function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var s=i(1),n=(s.addons.classSet,s.addons.cloneWithProps);t.exports=s.createClass({displayName:"Sortable",propTypes:{onSort:s.PropTypes.func,horizontal:s.PropTypes.bool,sensitivity:function(t,e){return isNaN(parseFloat(t[e]))&&!isFinite(t[e])||t[e]<0||t[e]>1?new Error("sensitivity must be a number from 0 to 1."):void 0}.bind(this),sinkUndraggables:s.PropTypes.bool,floatUndraggables:s.PropTypes.bool},getDefaultProps:function(){return{onSort:function(){},horizontal:!1,sinkUndraggables:!1,sensitivity:0}},getInitialState:function(){return this.rerender(this.props.children),{isDragging:!1,placeHolderIndex:null,left:null,top:null}},componentWillReceiveProps:function(t){this.props.children!==t.children&&this.rerender(t.children)},rerender:function(t){this._firstDraggable=0,this._lastDraggable=s.Children.count(t)-1;var e=!1;this._orderArr=[],this._dimensionArr=t.map(function(t,i){return this.props.sinkUndraggables&&!t.props.isDraggable&&i<=this._lastDraggable&&!e?(this._lastDraggable=i-1,e=!0):this.props.floatUndraggables&&!t.props.isDraggable&&i>=this._firstDraggable&&(this._firstDraggable=i+1),this._orderArr.push(i),{}}.bind(this))},componentDidMount:function(){this._dragDimensions=null},componentWillUnmount:function(){this.unbindEvent()},bindEvent:function(){document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)},unbindEvent:function(){document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp)},handleMouseDown:function(t,e){this.containerWidth=this.getDOMNode().offsetWidth,this.containerHeight=this.getDOMNode().offsetHeight,this._draggingIndex=e,this._prevX=t.pageX,this._prevY=t.pageY,this._initOffset=t.offset,this.bindEvent()},handleMouseMove:function(t){var e=this.calculateNewOffset(t),i=this.calculateNewIndex(t),s={isDragging:!0,top:e.top,left:e.left};-1!==i&&(this._draggingIndex=i,s.placeHolderIndex=i),this.setState(s),this._prevX=t.pageX,this._prevY=t.pageY},handleMouseUp:function(){this.unbindEvent(),this._draggingIndex=null,this._initOffset=null,this._prevX=null,this._prevY=null,this._dragDimensions=null,this.state.isDragging&&this.props.onSort(this.getSortData()),this.isMounted()&&this.setState({isDragging:!1,placeHolderIndex:null,left:null,top:null})},handleChildUpdate:function(t,e,i,n){this._dimensionArr[n]=s.addons.update(this._dimensionArr[n],{top:{$set:t.top},left:{$set:t.left},width:{$set:e},height:{$set:i}})},getIndexByOffset:function(t,e){if(!t||!this.isNumeric(t.top)||!this.isNumeric(t.left))return-1;var i,s=t.left,n=t.top,r=null!==this.state.placeHolderIndex?this.state.placeHolderIndex:this._draggingIndex;return i=this.props.horizontal?this.getHorizontalIndexOffset(s,n,e):this.getVerticalIndexOffset(s,n,e),void 0!==i?i:r},getVerticalIndexOffset:function(t,e,i){var s,n=this._dimensionArr[this._dimensionArr.length-1],r=1-this.props.sensitivity;return this._dimensionArr.every(function(o,a){var h=t-o.left,l=e-o.top;return 0>e?(s=0,!1):e>this.containerHeight||e>n.top+n.height?(s=this._dimensionArr.length-1,!1):l<o.height&&h<o.width?(l<o.height/2-o.height/4*r&&"up"===i?s=a:l>o.height/2+o.height/4*r&&"down"===i&&(s=Math.min(a+1,this._dimensionArr.length-1)),!1):!0}.bind(this)),s},getHorizontalIndexOffset:function(t,e,i){var s,n=this._dimensionArr[this._dimensionArr.length-1],r=1-this.props.sensitivity;return this._dimensionArr.every(function(o,a){{var h=t-o.left;e-o.top}return 0>t?(s=0,!1):t>this.containerWidth||t>n.left+n.width?(s=this._dimensionArr.length-1,!1):h<o.width?(h<o.width/2-o.width/4*r&&"left"===i?s=a:h>o.width/2+o.width/4*r&&"right"===i&&(s=Math.min(a+1,this._dimensionArr.length-1)),!1):!0}.bind(this)),s},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},swapArrayItemPosition:function(t,e,i){if(!t||!this.isNumeric(e)||!this.isNumeric(i))return t;var s=t.splice(e,1)[0];return t.splice(i,0,s),t},calculateNewOffset:function(t){var e=this._prevX-t.pageX,i=this._prevY-t.pageY,s=null!==this.state.left?this.state.left:this._initOffset.left,n=null!==this.state.top?this.state.top:this._initOffset.top,r=s-e,o=n-i;return{left:r,top:o}},getPosition:function(){return{left:this.getDOMNode().offsetLeft,top:this.getDOMNode().offsetTop}},closest:function(t,e){return t&&(e(t)?t:this.closest(t.parentNode,e))},calculateNewIndex:function(t){var e,i=null!==this.state.placeHolderIndex?this.state.placeHolderIndex:this._draggingIndex,s=this.closest(t.target,function(t){return"undefined"==typeof t||"undefined"==typeof t.classList?!1:t.classList.contains("SortableItem")});s&&(e={left:s.offsetLeft,top:s.offsetTop});var n="";n=this.props.horizontal?this._prevX>t.pageX?"left":"right":this._prevY>t.pageY?"up":"down";var r=this.getIndexByOffset(e,n);return-1!==r&&r<this._firstDraggable?(r=this._firstDraggable,this._draggingIndex<this._firstDraggable&&(r=this._firstDraggable-1,this._firstDraggable-=1)):-1!==r&&r>this._lastDraggable&&(r=this._lastDraggable,this._draggingIndex>this._lastDraggable&&(r=this._lastDraggable+1,this._lastDraggable+=1)),-1!==r&&r!==i&&(this._dimensionArr=this.swapArrayItemPosition(this._dimensionArr,i,r),this._orderArr=this.swapArrayItemPosition(this._orderArr,i,r)),r},getSortData:function(){return this._orderArr.map(function(t){return this.props.children[t].props.sortData}.bind(this))},renderItems:function(){var t=[],e=(s.Children.count(this.props.children),this._orderArr.map(function(e,i){var s=this.props.children[e];return i===this._draggingIndex&&s.props.isDraggable&&(null===this._dragDimensions&&(this._dragDimensions={width:this._dimensionArr[this._draggingIndex].width,height:this._dimensionArr[this._draggingIndex].height}),t.push(this.renderDraggingItem(s))),n(s,{key:i,_isPlaceholder:i===this.state.placeHolderIndex,sortableIndex:i,onSortableItemMouseDown:function(t){this.handleMouseDown(t,i)}.bind(this),onSortableItemMount:this.handleChildUpdate})}.bind(this)));return e.concat(t)},renderDraggingItem:function(t){var e={top:this.state.top,left:this.state.left,width:this._dragDimensions.width,height:this._dragDimensions.height};return n(t,{key:this._dimensionArr.length,sortableStyle:e,_isDragging:!0})},render:function(){return s.createElement("div",{className:"Sortable",ref:"movable"},this.renderItems())}})},function(t){t.exports=React}]);